// Auto-generated by case_mapping_staged_generator.h
// DO NOT EDIT MANUALLY

#ifndef CASE_MAPPING_STAGED_H
#define CASE_MAPPING_STAGED_H

#include <stddef.h>
#include <stdint.h>
#include <wctype.h>


// Level 1: maps upper 8 bits to level2 offset
inline constexpr uint16_t to_upper_level1[491] = {
#include "case_mapping_upper_level1_staged.inc"
};

// Level 2: target codepoints (0 = no mapping, return identity)
inline constexpr uint32_t to_upper_level2[6912] = {
#include "case_mapping_upper_level2_staged.inc"
};

// Level 1: maps upper 8 bits to level2 offset
inline constexpr uint16_t to_lower_level1[491] = {
#include "case_mapping_lower_level1_staged.inc"
};

// Level 2: target codepoints (0 = no mapping, return identity)
inline constexpr uint32_t to_lower_level2[6144] = {
#include "case_mapping_lower_level2_staged.inc"
};

inline wint_t towupper_impl(wint_t wc) {
  // Handle special cases
  if (wc == WEOF) {
    return WEOF;
  }

  // Out of valid Unicode range
  if (wc < 0 || wc > 0x10FFFF || (wc >= 0xD800 && wc <= 0xDFFF)) {
    return wc;
  }

  // ASCII fast path
  if (wc >= 'a' && wc <= 'z') {
    return wc - 32;
  }
  if (wc <= 0x7F) {
    return wc;  // ASCII non-letters
  }

  unsigned l1_idx = wc >> 8;
  if (l1_idx >= 491) {
    return wc;  // Beyond table range
  }

  unsigned l2_offset = to_upper_level1[l1_idx];
  unsigned l2_idx = l2_offset + (wc & 0xFF);

  uint32_t target = to_upper_level2[l2_idx];
  return target ? target : wc;  // Return target or identity if 0
}

inline wint_t towlower_impl(wint_t wc) {
  // Handle special cases
  if (wc == WEOF) {
    return WEOF;
  }

  // Out of valid Unicode range
  if (wc < 0 || wc > 0x10FFFF || (wc >= 0xD800 && wc <= 0xDFFF)) {
    return wc;
  }

  // ASCII fast path
  if (wc >= 'A' && wc <= 'Z') {
    return wc + 32;
  }
  if (wc <= 0x7F) {
    return wc;  // ASCII non-letters
  }

  unsigned l1_idx = wc >> 8;
  if (l1_idx >= 491) {
    return wc;  // Beyond table range
  }

  unsigned l2_offset = to_lower_level1[l1_idx];
  unsigned l2_idx = l2_offset + (wc & 0xFF);

  uint32_t target = to_lower_level2[l2_idx];
  return target ? target : wc;  // Return target or identity if 0
}

#endif // CASE_MAPPING_STAGED_H
